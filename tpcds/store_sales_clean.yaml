name: ${prefix}store_sales_clean
node_type: transform
display_name: Store Sales Clean
description: Cleaned store sales with business-friendly column names
query: |
  SELECT
    ss_sold_date_sk AS sold_date_key,
    ss_item_sk AS item_key,
    ss_customer_sk AS customer_key,
    ss_store_sk AS store_key,
    ss_promo_sk AS promo_key,
    ss_ticket_number AS ticket_number,
    ss_quantity AS quantity,
    ss_sales_price AS sales_price,
    ss_ext_sales_price AS extended_sales_price,
    ss_ext_discount_amt AS discount_amount,
    ss_ext_tax AS tax_amount,
    ss_coupon_amt AS coupon_amount,
    ss_net_paid AS net_paid,
    ss_net_paid_inc_tax AS net_paid_inc_tax,
    ss_net_profit AS net_profit
  FROM ${prefix}store_sales
dimension_links:
  - type: join
    dimension_node: ${prefix}date
    join_on: ${prefix}store_sales_clean.sold_date_key = ${prefix}date.date_key
  - type: join
    dimension_node: ${prefix}product
    join_on: ${prefix}store_sales_clean.item_key = ${prefix}product.item_key
  - type: join
    dimension_node: ${prefix}customer_dim
    join_on: ${prefix}store_sales_clean.customer_key = ${prefix}customer_dim.customer_key
  - type: join
    dimension_node: ${prefix}store_dim
    join_on: ${prefix}store_sales_clean.store_key = ${prefix}store_dim.store_key
  - type: join
    dimension_node: ${prefix}promo
    join_on: ${prefix}store_sales_clean.promo_key = ${prefix}promo.promo_key
