name: ${prefix}catalog_sales_clean
node_type: transform
display_name: Catalog Sales Clean
description: Cleaned catalog sales with business-friendly column names
query: |
  SELECT
    cs_sold_date_sk AS sold_date_key,
    cs_ship_date_sk AS ship_date_key,
    cs_item_sk AS item_key,
    cs_bill_customer_sk AS customer_key,
    cs_warehouse_sk AS warehouse_key,
    cs_promo_sk AS promo_key,
    cs_order_number AS order_number,
    cs_quantity AS quantity,
    cs_sales_price AS sales_price,
    cs_ext_sales_price AS extended_sales_price,
    cs_ext_discount_amt AS discount_amount,
    cs_ext_tax AS tax_amount,
    cs_coupon_amt AS coupon_amount,
    cs_ext_ship_cost AS shipping_cost,
    cs_net_paid AS net_paid,
    cs_net_paid_inc_tax AS net_paid_inc_tax,
    cs_net_paid_inc_ship AS net_paid_inc_ship,
    cs_net_profit AS net_profit
  FROM ${prefix}catalog_sales
dimension_links:
  - type: join
    dimension_node: ${prefix}date
    join_on: ${prefix}catalog_sales_clean.sold_date_key = ${prefix}date.date_key
  - type: join
    dimension_node: ${prefix}product
    join_on: ${prefix}catalog_sales_clean.item_key = ${prefix}product.item_key
  - type: join
    dimension_node: ${prefix}customer_dim
    join_on: ${prefix}catalog_sales_clean.customer_key = ${prefix}customer_dim.customer_key
  - type: join
    dimension_node: ${prefix}promo
    join_on: ${prefix}catalog_sales_clean.promo_key = ${prefix}promo.promo_key
